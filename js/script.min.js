function refreshCaptcha(e,t){t||(t="index.php?option=com_rsform&task=captcha&componentId="+e),document.getElementById("captcha"+e).src=t+"&"+Math.random(),document.getElementById("captchaTxt"+e).value="",document.getElementById("captchaTxt"+e).focus()}function number_format(e,t,n,o){var r=e,a=t;r=isFinite(+r)?+r:0,a=isFinite(+a)?Math.abs(a):0;var s,m,l=void 0===o?",":o,c=void 0===n?".":n,d=a>0?r.toFixed(a):Math.round(r).toFixed(a),i=Math.abs(r).toFixed(a);return i>=1e3?(m=(s=i.split(/\D/))[0].length%3||3,s[0]=d.slice(0,m+(r<0))+s[0].slice(m).replace(/(\d{3})/g,l+"$1"),d=s.join(c)):d=d.replace(".",c),d}function buildXmlHttp(){var e;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return alert("Your browser does not support AJAX!"),!1}}}return e}function ajaxValidation(e,t){try{e.elements.length}catch(t){e=this}var n=buildXmlHttp(),o="index.php?option=com_rsform&task=ajaxValidate";t&&(o+="&page="+t);var r=new Array,a=new Array,s=!1,m=0;for(i=0;i<e.elements.length;i++)if(e.elements[i].name&&0!=e.elements[i].name.length&&!("checkbox"==e.elements[i].type&&0==e.elements[i].checked||"radio"==e.elements[i].type&&0==e.elements[i].checked))if("submit"==e.elements[i].type&&(a.push(e.elements[i]),e.elements[i].disabled=!0),"select-multiple"!=e.elements[i].type)"form[formId]"==e.elements[i].name&&(m=e.elements[i].value),r.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].value));else for(var l=0;l<e.elements[i].options.length;l++)e.elements[i].options[l].selected&&r.push(e.elements[i].name+"="+encodeURIComponent(e.elements[i].options[l].value));r=r.join("&"),n.open("POST",o,!1),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.setRequestHeader("Content-length",r.length),n.setRequestHeader("Connection","close"),n.send(r);s=!0;if(-1!=n.responseText.indexOf("\n")){for(var c=n.responseText.split("\n"),d=c[0].split(","),i=0;i<d.length;i++)!isNaN(parseInt(d[i]))&&document.getElementById("component"+d[i])&&(document.getElementById("component"+d[i]).className="formNoError");for(d=c[1].split(","),i=0;i<d.length;i++)!isNaN(parseInt(d[i]))&&document.getElementById("component"+d[i])&&(document.getElementById("component"+d[i]).className="formError",s=!1);4==c.length&&(t=parseInt(c[2])-1,totalPages=parseInt(c[3]),rsfp_changePage(m,t,totalPages,!1));for(i=0;i<a.length;i++)a[i].disabled=!1}if(0==s&&document.getElementById("rsform_error_"+m))try{document.getElementById("rsform_error_"+m).style.display=""}catch(e){}return s}function rsfp_addEvent(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),!0):!!e.attachEvent&&e.attachEvent("on"+t,n)}function rsfp_getForm(e){for(var t=document.getElementsByName("form[formId]"),n=0;n<t.length;n++)if(parseInt(t[n].value)==parseInt(e)){var o=t[n].parentNode;if("FORM"==o.tagName||"FORM"==o.nodeName)return o;for(;o.parentNode;)if("FORM"==(o=o.parentNode).tagName||"FORM"==o.nodeName)return o}}